<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>dist/novacreator.bootstrap.datagrid.js - novacreator-bootstrap-data-grid</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="novacreator-bootstrap-data-grid"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/ajaxSettings.html">ajaxSettings</a></li>
            
                <li><a href="../classes/css.html">css</a></li>
            
                <li><a href="../classes/defaults.html">defaults</a></li>
            
                <li><a href="../classes/Grid.html">Grid</a></li>
            
                <li><a href="../classes/searchSettings.html">searchSettings</a></li>
            
                <li><a href="../classes/statusMapping.html">statusMapping</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: dist/novacreator.bootstrap.datagrid.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*! 
 * Nova Creator Bootstrap Datagrid v1.0.0 - 05/28/2016
 * Copyright (c) 2015-2016 Nova Creator Software (https://github.com/NovaCreatorSoftware/bootstrap-data-grid)
 * Licensed under MIT http://www.opensource.org/licenses/MIT
 */
;(function ($, window, undefined)
{
    /*jshint validthis: true */
    &quot;use strict&quot;;

// GRID INTERNAL FIELDS
// ====================

var namespace = &quot;.rs.jquery.bootgrid&quot;;

// GRID INTERNAL FUNCTIONS
// =====================

function appendRow(row)
{
    var that = this;

    function exists(item)
    {
        return that.identifier &amp;&amp; item[that.identifier] === row[that.identifier];
    }

    if (!this.rows.contains(exists))
    {
        this.rows.push(row);
        return true;
    }

    return false;
}

function findFooterAndHeaderItems(selector)
{
    var footer = (this.footer) ? this.footer.find(selector) : $(),
        header = (this.header) ? this.header.find(selector) : $();
    return $.merge(footer, header);
}

function getParams(context)
{
    return (context) ? $.extend({}, this.cachedParams, { ctx: context }) :
        this.cachedParams;
}

function getRequest()
{
    var request = {
            current: this.current,
            rowCount: this.rowCount,
            sort: this.sortDictionary,
            searchPhrase: this.searchPhrase
        },
        post = this.options.post;

    post = ($.isFunction(post)) ? post() : post;
    return this.options.requestHandler($.extend(true, request, post));
}

function getCssSelector(css)
{
    return &quot;.&quot; + $.trim(css).replace(/\s+/gm, &quot;.&quot;);
}

function getUrl()
{
    var url = this.options.url;
    return ($.isFunction(url)) ? url() : url;
}

function init()
{
    this.element.trigger(&quot;initialize&quot; + namespace);

    loadColumns.call(this); // Loads columns from HTML thead tag
    this.selection = this.options.selection &amp;&amp; this.identifier != null;
    loadRows.call(this); // Loads rows from HTML tbody tag if ajax is false
    prepareTable.call(this);
    renderTableHeader.call(this);
    renderSearchField.call(this);
    renderActions.call(this);
    loadData.call(this);

    this.element.trigger(&quot;initialized&quot; + namespace);
}

function highlightAppendedRows(rows)
{
    if (this.options.highlightRows)
    {
        // todo: implement
    }
}

function isVisible(column)
{
    return column.visible;
}

function loadColumns()
{
    var that = this,
        firstHeadRow = this.element.find(&quot;thead &gt; tr&quot;).first(),
        sorted = false;

    /*jshint -W018*/
    firstHeadRow.children().each(function ()
    {
        var $this = $(this),
            data = $this.data(),
            column = {
                id: data.columnId,
                identifier: that.identifier == null &amp;&amp; data.identifier || false,
                converter: that.options.converters[data.converter || data.type] || that.options.converters[&quot;string&quot;],
                text: $this.text(),
                align: data.align || &quot;left&quot;,
                headerAlign: data.headerAlign || &quot;left&quot;,
                cssClass: data.cssClass || &quot;&quot;,
                headerCssClass: data.headerCssClass || &quot;&quot;,
                formatter: that.options.formatters[data.formatter] || null,
                order: (!sorted &amp;&amp; (data.order === &quot;asc&quot; || data.order === &quot;desc&quot;)) ? data.order : null,
                searchable: !(data.searchable === false), // default: true
                sortable: !(data.sortable === false), // default: true
                visible: !(data.visible === false), // default: true
                visibleInSelection: !(data.visibleInSelection === false), // default: true
                width: ($.isNumeric(data.width)) ? data.width + &quot;px&quot; : 
                    (typeof(data.width) === &quot;string&quot;) ? data.width : null
            };
        that.columns.push(column);
        if (column.order != null)
        {
            that.sortDictionary[column.id] = column.order;
        }

        // Prevents multiple identifiers
        if (column.identifier)
        {
            that.identifier = column.id;
            that.converter = column.converter;
        }

        // ensures that only the first order will be applied in case of multi sorting is disabled
        if (!that.options.multiSort &amp;&amp; column.order !== null)
        {
            sorted = true;
        }
    });
    /*jshint +W018*/
}

/*
response = {
    current: 1,
    rowCount: 10,
    rows: [{}, {}],
    sort: [{ &quot;columnId&quot;: &quot;asc&quot; }],
    total: 101
}
*/

function loadData()
{
    var that = this;

    this.element._bgBusyAria(true).trigger(&quot;load&quot; + namespace);
    showLoading.call(this);

    function containsPhrase(row)
    {
        var column,
            searchPattern = new RegExp(that.searchPhrase, (that.options.caseSensitive) ? &quot;g&quot; : &quot;gi&quot;);

        for (var i = 0; i &lt; that.columns.length; i++)
        {
            column = that.columns[i];
            if (column.searchable &amp;&amp; column.visible &amp;&amp;
                column.converter.to(row[column.id]).search(searchPattern) &gt; -1)
            {
                return true;
            }
        }

        return false;
    }

    function update(rows, total)
    {
        that.currentRows = rows;
        setTotals.call(that, total);

        if (!that.options.keepSelection)
        {
            that.selectedRows = [];
        }

        renderRows.call(that, rows);
        renderInfos.call(that);
        renderPagination.call(that);

        that.element._bgBusyAria(false).trigger(&quot;loaded&quot; + namespace);
    }

    if (this.options.ajax)
    {
        var request = getRequest.call(this),
            url = getUrl.call(this);

        if (url == null || typeof url !== &quot;string&quot; || url.length === 0)
        {
            throw new Error(&quot;Url setting must be a none empty string or a function that returns one.&quot;);
        }

        // aborts the previous ajax request if not already finished or failed
        if (this.xqr)
        {
            this.xqr.abort();
        }

        var settings = {
            url: url,
            data: request,
            success: function(response)
            {
                that.xqr = null;

                if (typeof (response) === &quot;string&quot;)
                {
                    response = $.parseJSON(response);
                }

                response = that.options.responseHandler(response);

                that.current = response.current;
                update(response.rows, response.total);
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                that.xqr = null;

                if (textStatus !== &quot;abort&quot;)
                {
                    renderNoResultsRow.call(that); // overrides loading mask
                    that.element._bgBusyAria(false).trigger(&quot;loaded&quot; + namespace);
                }
            }
        };
        settings = $.extend(this.options.ajaxSettings, settings);

        this.xqr = $.ajax(settings);
    }
    else
    {
        var rows = (this.searchPhrase.length &gt; 0) ? this.rows.where(containsPhrase) : this.rows,
            total = rows.length;
        if (this.rowCount !== -1)
        {
            rows = rows.page(this.current, this.rowCount);
        }

        // todo: improve the following comment
        // setTimeout decouples the initialization so that adding event handlers happens before
        window.setTimeout(function () { update(rows, total); }, 10);
    }
}

function loadRows()
{
    if (!this.options.ajax)
    {
        var that = this,
            rows = this.element.find(&quot;tbody &gt; tr&quot;);

        rows.each(function ()
        {
            var $this = $(this),
                cells = $this.children(&quot;td&quot;),
                row = {};

            $.each(that.columns, function (i, column)
            {
                row[column.id] = column.converter.from(cells.eq(i).text());
            });

            appendRow.call(that, row);
        });

        setTotals.call(this, this.rows.length);
        sortRows.call(this);
    }
}

function setTotals(total)
{
    this.total = total;
    this.totalPages = (this.rowCount === -1) ? 1 :
        Math.ceil(this.total / this.rowCount);
}

function prepareTable()
{
    var tpl = this.options.templates,
        wrapper = (this.element.parent().hasClass(this.options.css.responsiveTable)) ?
            this.element.parent() : this.element;

    this.element.addClass(this.options.css.table);

    // checks whether there is an tbody element; otherwise creates one
    if (this.element.children(&quot;tbody&quot;).length === 0)
    {
        this.element.append(tpl.body);
    }

    if (this.options.navigation &amp; 1)
    {
        this.header = $(tpl.header.resolve(getParams.call(this, { id: this.element._bgId() + &quot;-header&quot; })));
        wrapper.before(this.header);
    }

    if (this.options.navigation &amp; 2)
    {
        this.footer = $(tpl.footer.resolve(getParams.call(this, { id: this.element._bgId() + &quot;-footer&quot; })));
        wrapper.after(this.footer);
    }
}

function renderActions()
{
    if (this.options.navigation !== 0)
    {
        var css = this.options.css,
            selector = getCssSelector(css.actions),
            actionItems = findFooterAndHeaderItems.call(this, selector);

        if (actionItems.length &gt; 0)
        {
            var that = this,
                tpl = this.options.templates,
                actions = $(tpl.actions.resolve(getParams.call(this)));

            // Refresh Button
            if (this.options.ajax)
            {
                var refreshIcon = tpl.icon.resolve(getParams.call(this, { iconCss: css.iconRefresh })),
                    refresh = $(tpl.actionButton.resolve(getParams.call(this,
                    { content: refreshIcon, text: this.options.labels.refresh })))
                        .on(&quot;click&quot; + namespace, function (e)
                        {
                            // todo: prevent multiple fast clicks (fast click detection)
                            e.stopPropagation();
                            that.current = 1;
                            loadData.call(that);
                        });
                actions.append(refresh);
            }

            // Row count selection
            renderRowCountSelection.call(this, actions);

            // Column selection
            renderColumnSelection.call(this, actions);

            replacePlaceHolder.call(this, actionItems, actions);
        }
    }
}

function renderColumnSelection(actions)
{
    if (this.options.columnSelection &amp;&amp; this.columns.length &gt; 1)
    {
        var that = this,
            css = this.options.css,
            tpl = this.options.templates,
            icon = tpl.icon.resolve(getParams.call(this, { iconCss: css.iconColumns })),
            dropDown = $(tpl.actionDropDown.resolve(getParams.call(this, { content: icon }))),
            selector = getCssSelector(css.dropDownItem),
            checkboxSelector = getCssSelector(css.dropDownItemCheckbox),
            itemsSelector = getCssSelector(css.dropDownMenuItems);

        $.each(this.columns, function (i, column)
        {
            if (column.visibleInSelection)
            {
                var item = $(tpl.actionDropDownCheckboxItem.resolve(getParams.call(that,
                    { name: column.id, label: column.text, checked: column.visible })))
                        .on(&quot;click&quot; + namespace, selector, function (e)
                        {
                            e.stopPropagation();
    
                            var $this = $(this),
                                checkbox = $this.find(checkboxSelector);
                            if (!checkbox.prop(&quot;disabled&quot;))
                            {
                                column.visible = checkbox.prop(&quot;checked&quot;);
                                var enable = that.columns.where(isVisible).length &gt; 1;
                                $this.parents(itemsSelector).find(selector + &quot;:has(&quot; + checkboxSelector + &quot;:checked)&quot;)
                                    ._bgEnableAria(enable).find(checkboxSelector)._bgEnableField(enable);
    
                                that.element.find(&quot;tbody&quot;).empty(); // Fixes an column visualization bug
                                renderTableHeader.call(that);
                                loadData.call(that);
                            }
                        });
                dropDown.find(getCssSelector(css.dropDownMenuItems)).append(item);
            }
        });
        actions.append(dropDown);
    }
}

function renderInfos()
{
    if (this.options.navigation !== 0)
    {
        var selector = getCssSelector(this.options.css.infos),
            infoItems = findFooterAndHeaderItems.call(this, selector);

        if (infoItems.length &gt; 0)
        {
            var end = (this.current * this.rowCount),
                infos = $(this.options.templates.infos.resolve(getParams.call(this, {
                    end: (this.total === 0 || end === -1 || end &gt; this.total) ? this.total : end,
                    start: (this.total === 0) ? 0 : (end - this.rowCount + 1),
                    total: this.total
                })));

            replacePlaceHolder.call(this, infoItems, infos);
        }
    }
}

function renderNoResultsRow()
{
    var tbody = this.element.children(&quot;tbody&quot;).first(),
        tpl = this.options.templates,
        count = this.columns.where(isVisible).length;

    if (this.selection)
    {
        count = count + 1;
    }
    tbody.html(tpl.noResults.resolve(getParams.call(this, { columns: count })));
}

function renderPagination()
{
    if (this.options.navigation !== 0)
    {
        var selector = getCssSelector(this.options.css.pagination),
            paginationItems = findFooterAndHeaderItems.call(this, selector)._bgShowAria(this.rowCount !== -1);

        if (this.rowCount !== -1 &amp;&amp; paginationItems.length &gt; 0)
        {
            var tpl = this.options.templates,
                current = this.current,
                totalPages = this.totalPages,
                pagination = $(tpl.pagination.resolve(getParams.call(this))),
                offsetRight = totalPages - current,
                offsetLeft = (this.options.padding - current) * -1,
                startWith = ((offsetRight &gt;= this.options.padding) ?
                    Math.max(offsetLeft, 1) :
                    Math.max((offsetLeft - this.options.padding + offsetRight), 1)),
                maxCount = this.options.padding * 2 + 1,
                count = (totalPages &gt;= maxCount) ? maxCount : totalPages;

            renderPaginationItem.call(this, pagination, &quot;first&quot;, &quot;&amp;laquo;&quot;, &quot;first&quot;)
                ._bgEnableAria(current &gt; 1);
            renderPaginationItem.call(this, pagination, &quot;prev&quot;, &quot;&amp;lt;&quot;, &quot;prev&quot;)
                ._bgEnableAria(current &gt; 1);

            for (var i = 0; i &lt; count; i++)
            {
                var pos = i + startWith;
                renderPaginationItem.call(this, pagination, pos, pos, &quot;page-&quot; + pos)
                    ._bgEnableAria()._bgSelectAria(pos === current);
            }

            if (count === 0)
            {
                renderPaginationItem.call(this, pagination, 1, 1, &quot;page-&quot; + 1)
                    ._bgEnableAria(false)._bgSelectAria();
            }

            renderPaginationItem.call(this, pagination, &quot;next&quot;, &quot;&amp;gt;&quot;, &quot;next&quot;)
                ._bgEnableAria(totalPages &gt; current);
            renderPaginationItem.call(this, pagination, &quot;last&quot;, &quot;&amp;raquo;&quot;, &quot;last&quot;)
                ._bgEnableAria(totalPages &gt; current);

            replacePlaceHolder.call(this, paginationItems, pagination);
        }
    }
}

function renderPaginationItem(list, page, text, markerCss)
{
    var that = this,
        tpl = this.options.templates,
        css = this.options.css,
        values = getParams.call(this, { css: markerCss, text: text, page: page }),
        item = $(tpl.paginationItem.resolve(values))
            .on(&quot;click&quot; + namespace, getCssSelector(css.paginationButton), function (e)
            {
                e.stopPropagation();
                e.preventDefault();

                var $this = $(this),
                    parent = $this.parent();
                if (!parent.hasClass(&quot;active&quot;) &amp;&amp; !parent.hasClass(&quot;disabled&quot;))
                {
                    var commandList = {
                        first: 1,
                        prev: that.current - 1,
                        next: that.current + 1,
                        last: that.totalPages
                    };
                    var command = $this.data(&quot;page&quot;);
                    that.current = commandList[command] || command;
                    loadData.call(that);
                }
                $this.trigger(&quot;blur&quot;);
            });

    list.append(item);
    return item;
}

function renderRowCountSelection(actions)
{
    var that = this,
        rowCountList = this.options.rowCount;

    function getText(value)
    {
        return (value === -1) ? that.options.labels.all : value;
    }

    if ($.isArray(rowCountList))
    {
        var css = this.options.css,
            tpl = this.options.templates,
            dropDown = $(tpl.actionDropDown.resolve(getParams.call(this, { content: getText(this.rowCount) }))),
            menuSelector = getCssSelector(css.dropDownMenu),
            menuTextSelector = getCssSelector(css.dropDownMenuText),
            menuItemsSelector = getCssSelector(css.dropDownMenuItems),
            menuItemSelector = getCssSelector(css.dropDownItemButton);

        $.each(rowCountList, function (index, value)
        {
            var item = $(tpl.actionDropDownItem.resolve(getParams.call(that,
                { text: getText(value), action: value })))
                    ._bgSelectAria(value === that.rowCount)
                    .on(&quot;click&quot; + namespace, menuItemSelector, function (e)
                    {
                        e.preventDefault();

                        var $this = $(this),
                            newRowCount = $this.data(&quot;action&quot;);
                        if (newRowCount !== that.rowCount)
                        {
                            // todo: sophisticated solution needed for calculating which page is selected
                            that.current = 1; // that.rowCount === -1 ---&gt; All
                            that.rowCount = newRowCount;
                            $this.parents(menuItemsSelector).children().each(function ()
                            {
                                var $item = $(this),
                                    currentRowCount = $item.find(menuItemSelector).data(&quot;action&quot;);
                                $item._bgSelectAria(currentRowCount === newRowCount);
                            });
                            $this.parents(menuSelector).find(menuTextSelector).text(getText(newRowCount));
                            loadData.call(that);
                        }
                    });
            dropDown.find(menuItemsSelector).append(item);
        });
        actions.append(dropDown);
    }
}

function renderRows(rows)
{
    if (rows.length &gt; 0)
    {
        var that = this,
            css = this.options.css,
            tpl = this.options.templates,
            tbody = this.element.children(&quot;tbody&quot;).first(),
            allRowsSelected = true,
            html = &quot;&quot;;

        $.each(rows, function (index, row)
        {
            var cells = &quot;&quot;,
                rowAttr = &quot; data-row-id=\&quot;&quot; + ((that.identifier == null) ? index : row[that.identifier]) + &quot;\&quot;&quot;,
                rowCss = &quot;&quot;;

            if (that.selection)
            {
                var selected = ($.inArray(row[that.identifier], that.selectedRows) !== -1),
                    selectBox = tpl.select.resolve(getParams.call(that,
                        { type: &quot;checkbox&quot;, value: row[that.identifier], checked: selected }));
                cells += tpl.cell.resolve(getParams.call(that, { content: selectBox, css: css.selectCell }));
                allRowsSelected = (allRowsSelected &amp;&amp; selected);
                if (selected)
                {
                    rowCss += css.selected;
                    rowAttr += &quot; aria-selected=\&quot;true\&quot;&quot;;
                }
            }

            var status = row.status != null &amp;&amp; that.options.statusMapping[row.status];
            if (status)
            {
                rowCss += status;
            }

            $.each(that.columns, function (j, column)
            {
                if (column.visible)
                {
                    var value = ($.isFunction(column.formatter)) ?
                            column.formatter.call(that, column, row) :
                                column.converter.to(row[column.id]),
                        cssClass = (column.cssClass.length &gt; 0) ? &quot; &quot; + column.cssClass : &quot;&quot;;
                    cells += tpl.cell.resolve(getParams.call(that, {
                        content: (value == null || value === &quot;&quot;) ? &quot;&amp;nbsp;&quot; : value,
                        css: ((column.align === &quot;right&quot;) ? css.right : (column.align === &quot;center&quot;) ?
                            css.center : css.left) + cssClass,
                        style: (column.width == null) ? &quot;&quot; : &quot;width:&quot; + column.width + &quot;;&quot; }));
                }
            });

            if (rowCss.length &gt; 0)
            {
                rowAttr += &quot; class=\&quot;&quot; + rowCss + &quot;\&quot;&quot;;
            }
            html += tpl.row.resolve(getParams.call(that, { attr: rowAttr, cells: cells }));
        });

        // sets or clears multi selectbox state
        that.element.find(&quot;thead &quot; + getCssSelector(that.options.css.selectBox))
            .prop(&quot;checked&quot;, allRowsSelected);

        tbody.html(html);

        registerRowEvents.call(this, tbody);
    }
    else
    {
        renderNoResultsRow.call(this);
    }
}

function registerRowEvents(tbody)
{
    var that = this,
        selectBoxSelector = getCssSelector(this.options.css.selectBox);

    if (this.selection)
    {
        tbody.off(&quot;click&quot; + namespace, selectBoxSelector)
            .on(&quot;click&quot; + namespace, selectBoxSelector, function(e)
            {
                e.stopPropagation();

                var $this = $(this),
                    id = that.converter.from($this.val());

                if ($this.prop(&quot;checked&quot;))
                {
                    that.select([id]);
                }
                else
                {
                    that.deselect([id]);
                }
            });
    }

    tbody.off(&quot;click&quot; + namespace, &quot;&gt; tr&quot;)
        .on(&quot;click&quot; + namespace, &quot;&gt; tr&quot;, function(e)
        {
            e.stopPropagation();

            var $this = $(this),
                id = (that.identifier == null) ? $this.data(&quot;row-id&quot;) :
                    that.converter.from($this.data(&quot;row-id&quot;) + &quot;&quot;),
                row = (that.identifier == null) ? that.currentRows[id] :
                    that.currentRows.first(function (item) { return item[that.identifier] === id; });

            if (that.selection &amp;&amp; that.options.rowSelect)
            {
                if ($this.hasClass(that.options.css.selected))
                {
                    that.deselect([id]);
                }
                else
                {
                    that.select([id]);
                }
            }

            that.element.trigger(&quot;click&quot; + namespace, [that.columns, row]);
        });
}

function renderSearchField()
{
    if (this.options.navigation !== 0)
    {
        var css = this.options.css,
            selector = getCssSelector(css.search),
            searchItems = findFooterAndHeaderItems.call(this, selector);

        if (searchItems.length &gt; 0)
        {
            var that = this,
                tpl = this.options.templates,
                timer = null, // fast keyup detection
                currentValue = &quot;&quot;,
                searchFieldSelector = getCssSelector(css.searchField),
                search = $(tpl.search.resolve(getParams.call(this))),
                searchField = (search.is(searchFieldSelector)) ? search :
                    search.find(searchFieldSelector);

            searchField.on(&quot;keyup&quot; + namespace, function (e)
            {
                e.stopPropagation();
                var newValue = $(this).val();
                if (currentValue !== newValue || (e.which === 13 &amp;&amp; newValue !== &quot;&quot;))
                {
                    currentValue = newValue;
                    if (e.which === 13 || newValue.length === 0 || newValue.length &gt;= that.options.searchSettings.characters)
                    {
                        window.clearTimeout(timer);
                        timer = window.setTimeout(function ()
                        {
                            executeSearch.call(that, newValue);
                        }, that.options.searchSettings.delay);
                    }
                }
            });

            replacePlaceHolder.call(this, searchItems, search);
        }
    }
}

function executeSearch(phrase)
{
    if (this.searchPhrase !== phrase)
    {
        this.current = 1;
        this.searchPhrase = phrase;
        loadData.call(this);
    }
}

function renderTableHeader()
{
    var that = this,
        headerRow = this.element.find(&quot;thead &gt; tr&quot;),
        css = this.options.css,
        tpl = this.options.templates,
        html = &quot;&quot;,
        sorting = this.options.sorting;

    if (this.selection)
    {
        var selectBox = (this.options.multiSelect) ?
            tpl.select.resolve(getParams.call(that, { type: &quot;checkbox&quot;, value: &quot;all&quot; })) : &quot;&quot;;
        html += tpl.rawHeaderCell.resolve(getParams.call(that, { content: selectBox,
            css: css.selectCell }));
    }

    $.each(this.columns, function (index, column)
    {
        if (column.visible)
        {
            var sortOrder = that.sortDictionary[column.id],
                iconCss = ((sorting &amp;&amp; sortOrder &amp;&amp; sortOrder === &quot;asc&quot;) ? css.iconUp :
                    (sorting &amp;&amp; sortOrder &amp;&amp; sortOrder === &quot;desc&quot;) ? css.iconDown : &quot;&quot;),
                icon = tpl.icon.resolve(getParams.call(that, { iconCss: iconCss })),
                align = column.headerAlign,
                cssClass = (column.headerCssClass.length &gt; 0) ? &quot; &quot; + column.headerCssClass : &quot;&quot;;
            html += tpl.headerCell.resolve(getParams.call(that, {
                column: column, icon: icon, sortable: sorting &amp;&amp; column.sortable &amp;&amp; css.sortable || &quot;&quot;,
                css: ((align === &quot;right&quot;) ? css.right : (align === &quot;center&quot;) ?
                    css.center : css.left) + cssClass,
                style: (column.width == null) ? &quot;&quot; : &quot;width:&quot; + column.width + &quot;;&quot; }));
        }
    });

    headerRow.html(html);

    if (sorting)
    {
        var sortingSelector = getCssSelector(css.sortable);
        headerRow.off(&quot;click&quot; + namespace, sortingSelector)
            .on(&quot;click&quot; + namespace, sortingSelector, function (e)
            {
                e.preventDefault();

                setTableHeaderSortDirection.call(that, $(this));
                sortRows.call(that);
                loadData.call(that);
            });
    }

    // todo: create a own function for that piece of code
    if (this.selection &amp;&amp; this.options.multiSelect)
    {
        var selectBoxSelector = getCssSelector(css.selectBox);
        headerRow.off(&quot;click&quot; + namespace, selectBoxSelector)
            .on(&quot;click&quot; + namespace, selectBoxSelector, function(e)
            {
                e.stopPropagation();

                if ($(this).prop(&quot;checked&quot;))
                {
                    that.select();
                }
                else
                {
                    that.deselect();
                }
            });
    }
}

function setTableHeaderSortDirection(element)
{
    var css = this.options.css,
        iconSelector = getCssSelector(css.icon),
        columnId = element.data(&quot;column-id&quot;) || element.parents(&quot;th&quot;).first().data(&quot;column-id&quot;),
        sortOrder = this.sortDictionary[columnId],
        icon = element.find(iconSelector);

    if (!this.options.multiSort)
    {
        element.parents(&quot;tr&quot;).first().find(iconSelector).removeClass(css.iconDown + &quot; &quot; + css.iconUp);
        this.sortDictionary = {};
    }

    if (sortOrder &amp;&amp; sortOrder === &quot;asc&quot;)
    {
        this.sortDictionary[columnId] = &quot;desc&quot;;
        icon.removeClass(css.iconUp).addClass(css.iconDown);
    }
    else if (sortOrder &amp;&amp; sortOrder === &quot;desc&quot;)
    {
        if (this.options.multiSort)
        {
            var newSort = {};
            for (var key in this.sortDictionary)
            {
                if (key !== columnId)
                {
                    newSort[key] = this.sortDictionary[key];
                }
            }
            this.sortDictionary = newSort;
            icon.removeClass(css.iconDown);
        }
        else
        {
            this.sortDictionary[columnId] = &quot;asc&quot;;
            icon.removeClass(css.iconDown).addClass(css.iconUp);
        }
    }
    else
    {
        this.sortDictionary[columnId] = &quot;asc&quot;;
        icon.addClass(css.iconUp);
    }
}

function replacePlaceHolder(placeholder, element)
{
    placeholder.each(function (index, item)
    {
        // todo: check how append is implemented. Perhaps cloning here is superfluous.
        $(item).before(element.clone(true)).remove();
    });
}

function showLoading()
{
    var that = this;

    window.setTimeout(function()
    {
        if (that.element._bgAria(&quot;busy&quot;) === &quot;true&quot;)
        {
            var tpl = that.options.templates,
                thead = that.element.children(&quot;thead&quot;).first(),
                tbody = that.element.children(&quot;tbody&quot;).first(),
                firstCell = tbody.find(&quot;tr &gt; td&quot;).first(),
                padding = (that.element.height() - thead.height()) - (firstCell.height() + 20),
                count = that.columns.where(isVisible).length;

            if (that.selection)
            {
                count = count + 1;
            }
            tbody.html(tpl.loading.resolve(getParams.call(that, { columns: count })));
            if (that.rowCount !== -1 &amp;&amp; padding &gt; 0)
            {
                tbody.find(&quot;tr &gt; td&quot;).css(&quot;padding&quot;, &quot;20px 0 &quot; + padding + &quot;px&quot;);
            }
        }
    }, 250);
}

function sortRows()
{
    var sortArray = [];

    function sort(x, y, current)
    {
        current = current || 0;
        var next = current + 1,
            item = sortArray[current];

        function sortOrder(value)
        {
            return (item.order === &quot;asc&quot;) ? value : value * -1;
        }

        return (x[item.id] &gt; y[item.id]) ? sortOrder(1) :
            (x[item.id] &lt; y[item.id]) ? sortOrder(-1) :
                (sortArray.length &gt; next) ? sort(x, y, next) : 0;
    }

    if (!this.options.ajax)
    {
        var that = this;

        for (var key in this.sortDictionary)
        {
            if (this.options.multiSort || sortArray.length === 0)
            {
                sortArray.push({
                    id: key,
                    order: this.sortDictionary[key]
                });
            }
        }

        if (sortArray.length &gt; 0)
        {
            this.rows.sort(sort);
        }
    }
    }

// GRID PUBLIC CLASS DEFINITION
// ====================

/**
 * Represents the jQuery Bootgrid plugin.
 *
 * @class Grid
 * @constructor
 * @param element {Object} The corresponding DOM element.
 * @param options {Object} The options to override default settings.
 * @chainable
 **/
var Grid = function(element, options)
{
    this.element = $(element);
    this.origin = this.element.clone();
    this.options = $.extend(true, {}, Grid.defaults, this.element.data(), options);
    // overrides rowCount explicitly because deep copy ($.extend) leads to strange behaviour
    var rowCount = this.options.rowCount = this.element.data().rowCount || options.rowCount || this.options.rowCount;
    this.columns = [];
    this.current = 1;
    this.currentRows = [];
    this.identifier = null; // The first column ID that is marked as identifier
    this.selection = false;
    this.converter = null; // The converter for the column that is marked as identifier
    this.rowCount = ($.isArray(rowCount)) ? rowCount[0] : rowCount;
    this.rows = [];
    this.searchPhrase = &quot;&quot;;
    this.selectedRows = [];
    this.sortDictionary = {};
    this.total = 0;
    this.totalPages = 0;
    this.cachedParams = {
        lbl: this.options.labels,
        css: this.options.css,
        ctx: {}
    };
    this.header = null;
    this.footer = null;
    this.xqr = null;

    // todo: implement cache
};

/**
 * An object that represents the default settings.
 *
 * @static
 * @class defaults
 * @for Grid
 * @example
 *   // Global approach
 *   $.bootgrid.defaults.selection = true;
 * @example
 *   // Initialization approach
 *   $(&quot;#bootgrid&quot;).bootgrid({ selection = true });
 **/
Grid.defaults = {
    navigation: 3, // it&#x27;s a flag: 0 = none, 1 = top, 2 = bottom, 3 = both (top and bottom)
    padding: 2, // page padding (pagination)
    columnSelection: true,
    rowCount: [10, 25, 50, -1], // rows per page int or array of int (-1 represents &quot;All&quot;)

    /**
     * Enables row selection (to enable multi selection see also &#x60;multiSelect&#x60;). Default value is &#x60;false&#x60;.
     *
     * @property selection
     * @type Boolean
     * @default false
     * @for defaults
     * @since 1.0.0
     **/
    selection: false,

    /**
     * Enables multi selection (&#x60;selection&#x60; must be set to &#x60;true&#x60; as well). Default value is &#x60;false&#x60;.
     *
     * @property multiSelect
     * @type Boolean
     * @default false
     * @for defaults
     * @since 1.0.0
     **/
    multiSelect: false,

    /**
     * Enables entire row click selection (&#x60;selection&#x60; must be set to &#x60;true&#x60; as well). Default value is &#x60;false&#x60;.
     *
     * @property rowSelect
     * @type Boolean
     * @default false
     * @for defaults
     * @since 1.1.0
     **/
    rowSelect: false,

    /**
     * Defines whether the row selection is saved internally on filtering, paging and sorting
     * (even if the selected rows are not visible).
     *
     * @property keepSelection
     * @type Boolean
     * @default false
     * @for defaults
     * @since 1.1.0
     **/
    keepSelection: false,

    highlightRows: false, // highlights new rows (find the page of the first new row)
    sorting: true,
    multiSort: false,

    /**
     * General search settings to configure the search field behaviour.
     *
     * @property searchSettings
     * @type Object
     * @for defaults
     * @since 1.2.0
     **/
    searchSettings: {
        /**
         * The time in milliseconds to wait before search gets executed.
         *
         * @property delay
         * @type Number
         * @default 250
         * @for searchSettings
         **/
        delay: 250,
        
        /**
         * The characters to type before the search gets executed.
         *
         * @property characters
         * @type Number
         * @default 1
         * @for searchSettings
         **/
        characters: 1
    },

    /**
     * Defines whether the data shall be loaded via an asynchronous HTTP (Ajax) request.
     *
     * @property ajax
     * @type Boolean
     * @default false
     * @for defaults
     **/
    ajax: false,

    /**
     * Ajax request settings that shall be used for server-side communication.
     * All setting except data, error, success and url can be overridden.
     * For the full list of settings go to http://api.jquery.com/jQuery.ajax/.
     *
     * @property ajaxSettings
     * @type Object
     * @for defaults
     * @since 1.2.0
     **/
    ajaxSettings: {
        /**
         * Specifies the HTTP method which shall be used when sending data to the server.
         * Go to http://api.jquery.com/jQuery.ajax/ for more details.
         * This setting is overriden for backward compatibility.
         *
         * @property method
         * @type String
         * @default &quot;POST&quot;
         * @for ajaxSettings
         **/
        method: &quot;POST&quot;
    },

    /**
     * Enriches the request object with additional properties. Either a &#x60;PlainObject&#x60; or a &#x60;Function&#x60;
     * that returns a &#x60;PlainObject&#x60; can be passed. Default value is &#x60;{}&#x60;.
     *
     * @property post
     * @type Object|Function
     * @default function (request) { return request; }
     * @for defaults
     * @deprecated Use instead &#x60;requestHandler&#x60;
     **/
    post: {}, // or use function () { return {}; } (reserved properties are &quot;current&quot;, &quot;rowCount&quot;, &quot;sort&quot; and &quot;searchPhrase&quot;)

    /**
     * Sets the data URL to a data service (e.g. a REST service). Either a &#x60;String&#x60; or a &#x60;Function&#x60;
     * that returns a &#x60;String&#x60; can be passed. Default value is &#x60;&quot;&quot;&#x60;.
     *
     * @property url
     * @type String|Function
     * @default &quot;&quot;
     * @for defaults
     **/
    url: &quot;&quot;, // or use function () { return &quot;&quot;; }

    /**
     * Defines whether the search is case sensitive or insensitive.
     *
     * @property caseSensitive
     * @type Boolean
     * @default true
     * @for defaults
     * @since 1.1.0
     **/
    caseSensitive: true,

    // note: The following properties should not be used via data-api attributes

    /**
     * Transforms the JSON request object in what ever is needed on the server-side implementation.
     *
     * @property requestHandler
     * @type Function
     * @default function (request) { return request; }
     * @for defaults
     * @since 1.1.0
     **/
    requestHandler: function (request) { return request; },

    /**
     * Transforms the response object into the expected JSON response object.
     *
     * @property responseHandler
     * @type Function
     * @default function (response) { return response; }
     * @for defaults
     * @since 1.1.0
     **/
    responseHandler: function (response) { return response; },

    /**
     * A list of converters.
     *
     * @property converters
     * @type Object
     * @for defaults
     * @since 1.0.0
     **/
    converters: {
        numeric: {
            from: function (value) { return +value; }, // converts from string to numeric
            to: function (value) { return value + &quot;&quot;; } // converts from numeric to string
        },
        string: {
            // default converter
            from: function (value) { return value; },
            to: function (value) { return value; }
        }
    },

    /**
     * Contains all css classes.
     *
     * @property css
     * @type Object
     * @for defaults
     **/
    css: {
        actions: &quot;actions btn-group&quot;, // must be a unique class name or constellation of class names within the header and footer
        center: &quot;text-center&quot;,
        columnHeaderAnchor: &quot;column-header-anchor&quot;, // must be a unique class name or constellation of class names within the column header cell
        columnHeaderText: &quot;text&quot;,
        dropDownItem: &quot;dropdown-item&quot;, // must be a unique class name or constellation of class names within the actionDropDown,
        dropDownItemButton: &quot;dropdown-item-button&quot;, // must be a unique class name or constellation of class names within the actionDropDown
        dropDownItemCheckbox: &quot;dropdown-item-checkbox&quot;, // must be a unique class name or constellation of class names within the actionDropDown
        dropDownMenu: &quot;dropdown btn-group&quot;, // must be a unique class name or constellation of class names within the actionDropDown
        dropDownMenuItems: &quot;dropdown-menu pull-right&quot;, // must be a unique class name or constellation of class names within the actionDropDown
        dropDownMenuText: &quot;dropdown-text&quot;, // must be a unique class name or constellation of class names within the actionDropDown
        footer: &quot;novagrid-footer container-fluid&quot;,
        header: &quot;novagrid-header container-fluid&quot;,
        icon: &quot;icon glyphicon&quot;,
        iconColumns: &quot;glyphicon-th-list&quot;,
        iconDown: &quot;glyphicon-chevron-down&quot;,
        iconRefresh: &quot;glyphicon-refresh&quot;,
        iconSearch: &quot;glyphicon-search&quot;,
        iconUp: &quot;glyphicon-chevron-up&quot;,
        infos: &quot;infos&quot;, // must be a unique class name or constellation of class names within the header and footer,
        left: &quot;text-left&quot;,
        pagination: &quot;pagination&quot;, // must be a unique class name or constellation of class names within the header and footer
        paginationButton: &quot;button&quot;, // must be a unique class name or constellation of class names within the pagination

        /**
         * CSS class to select the parent div which activates responsive mode.
         *
         * @property responsiveTable
         * @type String
         * @default &quot;table-responsive&quot;
         * @for css
         * @since 1.1.0
         **/
        responsiveTable: &quot;table-responsive&quot;,

        right: &quot;text-right&quot;,
        search: &quot;search form-group&quot;, // must be a unique class name or constellation of class names within the header and footer
        searchField: &quot;search-field form-control&quot;,
        selectBox: &quot;select-box&quot;, // must be a unique class name or constellation of class names within the entire table
        selectCell: &quot;select-cell&quot;, // must be a unique class name or constellation of class names within the entire table

        /**
         * CSS class to highlight selected rows.
         *
         * @property selected
         * @type String
         * @default &quot;active&quot;
         * @for css
         * @since 1.1.0
         **/
        selected: &quot;active&quot;,

        sortable: &quot;sortable&quot;,
        table: &quot;novagrid-table table&quot;
    },

    /**
     * A dictionary of formatters.
     *
     * @property formatters
     * @type Object
     * @for defaults
     * @since 1.0.0
     **/
    formatters: {},

    /**
     * Contains all labels.
     *
     * @property labels
     * @type Object
     * @for defaults
     **/
    labels: {
        all: &quot;All&quot;,
        infos: &quot;Showing {{ctx.start}} to {{ctx.end}} of {{ctx.total}} entries&quot;,
        loading: &quot;Loading...&quot;,
        noResults: &quot;No results found!&quot;,
        refresh: &quot;Refresh&quot;,
        search: &quot;Search&quot;
    },

    /**
     * Specifies the mapping between status and contextual classes to color rows.
     *
     * @property statusMapping
     * @type Object
     * @for defaults
     * @since 1.2.0
     **/
    statusMapping: {
        /**
         * Specifies a successful or positive action.
         *
         * @property 0
         * @type String
         * @for statusMapping
         **/
        0: &quot;success&quot;,

        /**
         * Specifies a neutral informative change or action.
         *
         * @property 1
         * @type String
         * @for statusMapping
         **/
        1: &quot;info&quot;,

        /**
         * Specifies a warning that might need attention.
         *
         * @property 2
         * @type String
         * @for statusMapping
         **/
        2: &quot;warning&quot;,
        
        /**
         * Specifies a dangerous or potentially negative action.
         *
         * @property 3
         * @type String
         * @for statusMapping
         **/
        3: &quot;danger&quot;
    },

    /**
     * Contains all templates.
     *
     * @property templates
     * @type Object
     * @for defaults
     **/
    templates: {
        actionButton: &quot;&lt;button class=\&quot;btn btn-default\&quot; type=\&quot;button\&quot; title=\&quot;{{ctx.text}}\&quot;&gt;{{ctx.content}}&lt;/button&gt;&quot;,
        actionDropDown: &quot;&lt;div class=\&quot;{{css.dropDownMenu}}\&quot;&gt;&lt;button class=\&quot;btn btn-default dropdown-toggle\&quot; type=\&quot;button\&quot; data-toggle=\&quot;dropdown\&quot;&gt;&lt;span class=\&quot;{{css.dropDownMenuText}}\&quot;&gt;{{ctx.content}}&lt;/span&gt; &lt;span class=\&quot;caret\&quot;&gt;&lt;/span&gt;&lt;/button&gt;&lt;ul class=\&quot;{{css.dropDownMenuItems}}\&quot; role=\&quot;menu\&quot;&gt;&lt;/ul&gt;&lt;/div&gt;&quot;,
        actionDropDownItem: &quot;&lt;li&gt;&lt;a data-action=\&quot;{{ctx.action}}\&quot; class=\&quot;{{css.dropDownItem}} {{css.dropDownItemButton}}\&quot;&gt;{{ctx.text}}&lt;/a&gt;&lt;/li&gt;&quot;,
        actionDropDownCheckboxItem: &quot;&lt;li&gt;&lt;label class=\&quot;{{css.dropDownItem}}\&quot;&gt;&lt;input name=\&quot;{{ctx.name}}\&quot; type=\&quot;checkbox\&quot; value=\&quot;1\&quot; class=\&quot;{{css.dropDownItemCheckbox}}\&quot; {{ctx.checked}} /&gt; {{ctx.label}}&lt;/label&gt;&lt;/li&gt;&quot;,
        actions: &quot;&lt;div class=\&quot;{{css.actions}}\&quot;&gt;&lt;/div&gt;&quot;,
        body: &quot;&lt;tbody&gt;&lt;/tbody&gt;&quot;,
        cell: &quot;&lt;td class=\&quot;{{ctx.css}}\&quot; style=\&quot;{{ctx.style}}\&quot;&gt;{{ctx.content}}&lt;/td&gt;&quot;,
        footer: &quot;&lt;div id=\&quot;{{ctx.id}}\&quot; class=\&quot;{{css.footer}}\&quot;&gt;&lt;div class=\&quot;row\&quot;&gt;&lt;div class=\&quot;col-sm-6\&quot;&gt;&lt;p class=\&quot;{{css.pagination}}\&quot;&gt;&lt;/p&gt;&lt;/div&gt;&lt;div class=\&quot;col-sm-6 infoBar\&quot;&gt;&lt;p class=\&quot;{{css.infos}}\&quot;&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&quot;,
        header: &quot;&lt;div id=\&quot;{{ctx.id}}\&quot; class=\&quot;{{css.header}}\&quot;&gt;&lt;div class=\&quot;row\&quot;&gt;&lt;div class=\&quot;col-sm-12 actionBar\&quot;&gt;&lt;p class=\&quot;{{css.search}}\&quot;&gt;&lt;/p&gt;&lt;p class=\&quot;{{css.actions}}\&quot;&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&quot;,
        headerCell: &quot;&lt;th data-column-id=\&quot;{{ctx.column.id}}\&quot; class=\&quot;{{ctx.css}}\&quot; style=\&quot;{{ctx.style}}\&quot;&gt;&lt;a href=\&quot;javascript:void(0);\&quot; class=\&quot;{{css.columnHeaderAnchor}} {{ctx.sortable}}\&quot;&gt;&lt;span class=\&quot;{{css.columnHeaderText}}\&quot;&gt;{{ctx.column.text}}&lt;/span&gt;{{ctx.icon}}&lt;/a&gt;&lt;/th&gt;&quot;,
        icon: &quot;&lt;span class=\&quot;{{css.icon}} {{ctx.iconCss}}\&quot;&gt;&lt;/span&gt;&quot;,
        infos: &quot;&lt;div class=\&quot;{{css.infos}}\&quot;&gt;{{lbl.infos}}&lt;/div&gt;&quot;,
        loading: &quot;&lt;tr&gt;&lt;td colspan=\&quot;{{ctx.columns}}\&quot; class=\&quot;loading\&quot;&gt;{{lbl.loading}}&lt;/td&gt;&lt;/tr&gt;&quot;,
        noResults: &quot;&lt;tr&gt;&lt;td colspan=\&quot;{{ctx.columns}}\&quot; class=\&quot;no-results\&quot;&gt;{{lbl.noResults}}&lt;/td&gt;&lt;/tr&gt;&quot;,
        pagination: &quot;&lt;ul class=\&quot;{{css.pagination}}\&quot;&gt;&lt;/ul&gt;&quot;,
        paginationItem: &quot;&lt;li class=\&quot;{{ctx.css}}\&quot;&gt;&lt;a data-page=\&quot;{{ctx.page}}\&quot; class=\&quot;{{css.paginationButton}}\&quot;&gt;{{ctx.text}}&lt;/a&gt;&lt;/li&gt;&quot;,
        rawHeaderCell: &quot;&lt;th class=\&quot;{{ctx.css}}\&quot;&gt;{{ctx.content}}&lt;/th&gt;&quot;, // Used for the multi select box
        row: &quot;&lt;tr{{ctx.attr}}&gt;{{ctx.cells}}&lt;/tr&gt;&quot;,
        search: &quot;&lt;div class=\&quot;{{css.search}}\&quot;&gt;&lt;div class=\&quot;input-group\&quot;&gt;&lt;span class=\&quot;{{css.icon}} input-group-addon {{css.iconSearch}}\&quot;&gt;&lt;/span&gt; &lt;input type=\&quot;text\&quot; class=\&quot;{{css.searchField}}\&quot; placeholder=\&quot;{{lbl.search}}\&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&quot;,
        select: &quot;&lt;input name=\&quot;select\&quot; type=\&quot;{{ctx.type}}\&quot; class=\&quot;{{css.selectBox}}\&quot; value=\&quot;{{ctx.value}}\&quot; {{ctx.checked}} /&gt;&quot;
    }
};

/**
 * Appends rows.
 *
 * @method append
 * @param rows {Array} An array of rows to append
 * @chainable
 **/
Grid.prototype.append = function(rows)
{
    if (this.options.ajax)
    {
        // todo: implement ajax PUT
    }
    else
    {
        var appendedRows = [];
        for (var i = 0; i &lt; rows.length; i++)
        {
            if (appendRow.call(this, rows[i]))
            {
                appendedRows.push(rows[i]);
            }
        }
        sortRows.call(this);
        highlightAppendedRows.call(this, appendedRows);
        loadData.call(this);
        this.element.trigger(&quot;appended&quot; + namespace, [appendedRows]);
    }

    return this;
};

/**
 * Removes all rows.
 *
 * @method clear
 * @chainable
 **/
Grid.prototype.clear = function()
{
    if (this.options.ajax)
    {
        // todo: implement ajax POST
    }
    else
    {
        var removedRows = $.extend([], this.rows);
        this.rows = [];
        this.current = 1;
        this.total = 0;
        loadData.call(this);
        this.element.trigger(&quot;cleared&quot; + namespace, [removedRows]);
    }

    return this;
};

/**
 * Removes the control functionality completely and transforms the current state to the initial HTML structure.
 *
 * @method destroy
 * @chainable
 **/
Grid.prototype.destroy = function()
{
    // todo: this method has to be optimized (the complete initial state must be restored)
    $(window).off(namespace);
    if (this.options.navigation &amp; 1)
    {
        this.header.remove();
    }
    if (this.options.navigation &amp; 2)
    {
        this.footer.remove();
    }
    this.element.before(this.origin).remove();

    return this;
};

/**
 * Resets the state and reloads rows.
 *
 * @method reload
 * @chainable
 **/
Grid.prototype.reload = function()
{
    this.current = 1; // reset
    loadData.call(this);

    return this;
};

/**
 * Removes rows by ids. Removes selected rows if no ids are provided.
 *
 * @method remove
 * @param [rowsIds] {Array} An array of rows ids to remove
 * @chainable
 **/
Grid.prototype.remove = function(rowIds)
{
    if (this.identifier != null)
    {
        var that = this;

        if (this.options.ajax)
        {
            // todo: implement ajax DELETE
        }
        else
        {
            rowIds = rowIds || this.selectedRows;
            var id,
                removedRows = [];

            for (var i = 0; i &lt; rowIds.length; i++)
            {
                id = rowIds[i];

                for (var j = 0; j &lt; this.rows.length; j++)
                {
                    if (this.rows[j][this.identifier] === id)
                    {
                        removedRows.push(this.rows[j]);
                        this.rows.splice(j, 1);
                        break;
                    }
                }
            }

            this.current = 1; // reset
            loadData.call(this);
            this.element.trigger(&quot;removed&quot; + namespace, [removedRows]);
        }
    }

    return this;
};

/**
 * Searches in all rows for a specific phrase (but only in visible cells). 
 * The search filter will be reseted, if no argument is provided.
 *
 * @method search
 * @param [phrase] {String} The phrase to search for
 * @chainable
 **/
Grid.prototype.search = function(phrase)
{
    phrase = phrase || &quot;&quot;;

    if (this.searchPhrase !== phrase)
    {
        var selector = getCssSelector(this.options.css.searchField),
            searchFields = findFooterAndHeaderItems.call(this, selector);
        searchFields.val(phrase);
    }

    executeSearch.call(this, phrase);


    return this;
};

/**
 * Selects rows by ids. Selects all visible rows if no ids are provided.
 * In server-side scenarios only visible rows are selectable.
 *
 * @method select
 * @param [rowsIds] {Array} An array of rows ids to select
 * @chainable
 **/
Grid.prototype.select = function(rowIds)
{
    if (this.selection)
    {
        rowIds = rowIds || this.currentRows.propValues(this.identifier);

        var id, i,
            selectedRows = [];

        while (rowIds.length &gt; 0 &amp;&amp; !(!this.options.multiSelect &amp;&amp; selectedRows.length === 1))
        {
            id = rowIds.pop();
            if ($.inArray(id, this.selectedRows) === -1)
            {
                for (i = 0; i &lt; this.currentRows.length; i++)
                {
                    if (this.currentRows[i][this.identifier] === id)
                    {
                        selectedRows.push(this.currentRows[i]);
                        this.selectedRows.push(id);
                        break;
                    }
                }
            }
        }

        if (selectedRows.length &gt; 0)
        {
            var selectBoxSelector = getCssSelector(this.options.css.selectBox),
                selectMultiSelectBox = this.selectedRows.length &gt;= this.currentRows.length;

            i = 0;
            while (!this.options.keepSelection &amp;&amp; selectMultiSelectBox &amp;&amp; i &lt; this.currentRows.length)
            {
                selectMultiSelectBox = ($.inArray(this.currentRows[i++][this.identifier], this.selectedRows) !== -1);
            }
            this.element.find(&quot;thead &quot; + selectBoxSelector).prop(&quot;checked&quot;, selectMultiSelectBox);

            if (!this.options.multiSelect)
            {
                this.element.find(&quot;tbody &gt; tr &quot; + selectBoxSelector + &quot;:checked&quot;)
                    .trigger(&quot;click&quot; + namespace);
            }

            for (i = 0; i &lt; this.selectedRows.length; i++)
            {
                this.element.find(&quot;tbody &gt; tr[data-row-id=\&quot;&quot; + this.selectedRows[i] + &quot;\&quot;]&quot;)
                    .addClass(this.options.css.selected)._bgAria(&quot;selected&quot;, &quot;true&quot;)
                    .find(selectBoxSelector).prop(&quot;checked&quot;, true);
            }

            this.element.trigger(&quot;selected&quot; + namespace, [selectedRows]);
        }
    }

    return this;
};

/**
 * Deselects rows by ids. Deselects all visible rows if no ids are provided.
 * In server-side scenarios only visible rows are deselectable.
 *
 * @method deselect
 * @param [rowsIds] {Array} An array of rows ids to deselect
 * @chainable
 **/
Grid.prototype.deselect = function(rowIds)
{
    if (this.selection)
    {
        rowIds = rowIds || this.currentRows.propValues(this.identifier);

        var id, i, pos,
            deselectedRows = [];

        while (rowIds.length &gt; 0)
        {
            id = rowIds.pop();
            pos = $.inArray(id, this.selectedRows);
            if (pos !== -1)
            {
                for (i = 0; i &lt; this.currentRows.length; i++)
                {
                    if (this.currentRows[i][this.identifier] === id)
                    {
                        deselectedRows.push(this.currentRows[i]);
                        this.selectedRows.splice(pos, 1);
                        break;
                    }
                }
            }
        }

        if (deselectedRows.length &gt; 0)
        {
            var selectBoxSelector = getCssSelector(this.options.css.selectBox);

            this.element.find(&quot;thead &quot; + selectBoxSelector).prop(&quot;checked&quot;, false);
            for (i = 0; i &lt; deselectedRows.length; i++)
            {
                this.element.find(&quot;tbody &gt; tr[data-row-id=\&quot;&quot; + deselectedRows[i][this.identifier] + &quot;\&quot;]&quot;)
                    .removeClass(this.options.css.selected)._bgAria(&quot;selected&quot;, &quot;false&quot;)
                    .find(selectBoxSelector).prop(&quot;checked&quot;, false);
            }

            this.element.trigger(&quot;deselected&quot; + namespace, [deselectedRows]);
        }
    }

    return this;
};

/**
 * Sorts the rows by a given sort descriptor dictionary. 
 * The sort filter will be reseted, if no argument is provided.
 *
 * @method sort
 * @param [dictionary] {Object} A sort descriptor dictionary that contains the sort information
 * @chainable
 **/
Grid.prototype.sort = function(dictionary)
{
    var values = (dictionary) ? $.extend({}, dictionary) : {};

    if (values === this.sortDictionary)
    {
        return this;
    }

    this.sortDictionary = values;
    renderTableHeader.call(this);
    sortRows.call(this);
    loadData.call(this);

    return this;
};

/**
 * Gets a list of the column settings.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getColumnSettings
 * @return {Array} Returns a list of the column settings.
 * @since 1.2.0
 **/
Grid.prototype.getColumnSettings = function()
{
    return $.merge([], this.columns);
};

/**
 * Gets the current page index.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getCurrentPage
 * @return {Number} Returns the current page index.
 * @since 1.2.0
 **/
Grid.prototype.getCurrentPage = function()
{
    return this.current;
};

/**
 * Gets the current rows.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getCurrentPage
 * @return {Array} Returns the current rows.
 * @since 1.2.0
 **/
Grid.prototype.getCurrentRows = function()
{
    return $.merge([], this.currentRows);
};

/**
 * Gets a number represents the row count per page.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getRowCount
 * @return {Number} Returns the row count per page.
 * @since 1.2.0
 **/
Grid.prototype.getRowCount = function()
{
    return this.rowCount;
};

/**
 * Gets the actual search phrase.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getSearchPhrase
 * @return {String} Returns the actual search phrase.
 * @since 1.2.0
 **/
Grid.prototype.getSearchPhrase = function()
{
    return this.searchPhrase;
};

/**
 * Gets the complete list of currently selected rows.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getSelectedRows
 * @return {Array} Returns all selected rows.
 * @since 1.2.0
 **/
Grid.prototype.getSelectedRows = function()
{
    return $.merge([], this.selectedRows);
};

/**
 * Gets the sort dictionary which represents the state of column sorting.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getSortDictionary
 * @return {Object} Returns the sort dictionary.
 * @since 1.2.0
 **/
Grid.prototype.getSortDictionary = function()
{
    return $.extend({}, this.sortDictionary);
};

/**
 * Gets a number represents the total page count.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getTotalPageCount
 * @return {Number} Returns the total page count.
 * @since 1.2.0
 **/
Grid.prototype.getTotalPageCount = function()
{
    return this.totalPages;
};

/**
 * Gets a number represents the total row count.
 * This method returns only for the first grid instance a value.
 * Therefore be sure that only one grid instance is catched by your selector.
 *
 * @method getTotalRowCount
 * @return {Number} Returns the total row count.
 * @since 1.2.0
 **/
Grid.prototype.getTotalRowCount = function()
{
    return this.total;
    };

// GRID COMMON TYPE EXTENSIONS
// ============

$.fn.extend({
    _bgAria: function (name, value)
    {
        return (value) ? this.attr(&quot;aria-&quot; + name, value) : this.attr(&quot;aria-&quot; + name);
    },

    _bgBusyAria: function(busy)
    {
        return (busy == null || busy) ? 
            this._bgAria(&quot;busy&quot;, &quot;true&quot;) : 
            this._bgAria(&quot;busy&quot;, &quot;false&quot;);
    },

    _bgRemoveAria: function (name)
    {
        return this.removeAttr(&quot;aria-&quot; + name);
    },

    _bgEnableAria: function (enable)
    {
        return (enable == null || enable) ? 
            this.removeClass(&quot;disabled&quot;)._bgAria(&quot;disabled&quot;, &quot;false&quot;) : 
            this.addClass(&quot;disabled&quot;)._bgAria(&quot;disabled&quot;, &quot;true&quot;);
    },

    _bgEnableField: function (enable)
    {
        return (enable == null || enable) ? 
            this.removeAttr(&quot;disabled&quot;) : 
            this.attr(&quot;disabled&quot;, &quot;disable&quot;);
    },

    _bgShowAria: function (show)
    {
        return (show == null || show) ? 
            this.show()._bgAria(&quot;hidden&quot;, &quot;false&quot;) :
            this.hide()._bgAria(&quot;hidden&quot;, &quot;true&quot;);
    },

    _bgSelectAria: function (select)
    {
        return (select == null || select) ? 
            this.addClass(&quot;active&quot;)._bgAria(&quot;selected&quot;, &quot;true&quot;) : 
            this.removeClass(&quot;active&quot;)._bgAria(&quot;selected&quot;, &quot;false&quot;);
    },

    _bgId: function (id)
    {
        return (id) ? this.attr(&quot;id&quot;, id) : this.attr(&quot;id&quot;);
    }
});

if (!String.prototype.resolve)
{
    var formatter = {
        &quot;checked&quot;: function(value)
        {
            if (typeof value === &quot;boolean&quot;)
            {
                return (value) ? &quot;checked=\&quot;checked\&quot;&quot; : &quot;&quot;;
            }
            return value;
        }
    };

    String.prototype.resolve = function (substitutes, prefixes)
    {
        var result = this;
        $.each(substitutes, function (key, value)
        {
            if (value != null &amp;&amp; typeof value !== &quot;function&quot;)
            {
                if (typeof value === &quot;object&quot;)
                {
                    var keys = (prefixes) ? $.extend([], prefixes) : [];
                    keys.push(key);
                    result = result.resolve(value, keys) + &quot;&quot;;
                }
                else
                {
                    if (formatter &amp;&amp; formatter[key] &amp;&amp; typeof formatter[key] === &quot;function&quot;)
                    {
                        value = formatter[key](value);
                    }
                    key = (prefixes) ? prefixes.join(&quot;.&quot;) + &quot;.&quot; + key : key;
                    var pattern = new RegExp(&quot;\\{\\{&quot; + key + &quot;\\}\\}&quot;, &quot;gm&quot;);
                    result = result.replace(pattern, (value.replace) ? value.replace(/\$/gi, &quot;&amp;#36;&quot;) : value);
                }
            }
        });
        return result;
    };
}

if (!Array.prototype.first)
{
    Array.prototype.first = function (condition)
    {
        for (var i = 0; i &lt; this.length; i++)
        {
            var item = this[i];
            if (condition(item))
            {
                return item;
            }
        }
        return null;
    };
}

if (!Array.prototype.contains)
{
    Array.prototype.contains = function (condition)
    {
        for (var i = 0; i &lt; this.length; i++)
        {
            var item = this[i];
            if (condition(item))
            {
                return true;
            }
        }
        return false;
    };
}

if (!Array.prototype.page)
{
    Array.prototype.page = function (page, size)
    {
        var skip = (page - 1) * size,
            end = skip + size;
        return (this.length &gt; skip) ? 
            (this.length &gt; end) ? this.slice(skip, end) : 
                this.slice(skip) : [];
    };
}

if (!Array.prototype.where)
{
    Array.prototype.where = function (condition)
    {
        var result = [];
        for (var i = 0; i &lt; this.length; i++)
        {
            var item = this[i];
            if (condition(item))
            {
                result.push(item);
            }
        }
        return result;
    };
}

if (!Array.prototype.propValues)
{
    Array.prototype.propValues = function (propName)
    {
        var result = [];
        for (var i = 0; i &lt; this.length; i++)
        {
            result.push(this[i][propName]);
        }
        return result;
    };
    }

// GRID PLUGIN DEFINITION
// =====================

var old = $.fn.bootgrid;

$.fn.bootgrid = function (option)
{
    var args = Array.prototype.slice.call(arguments, 1),
        returnValue = null,
        elements = this.each(function (index)
        {
            var $this = $(this),
                instance = $this.data(namespace),
                options = typeof option === &quot;object&quot; &amp;&amp; option;

            if (!instance &amp;&amp; option === &quot;destroy&quot;)
            {
                return;
            }
            if (!instance)
            {
                $this.data(namespace, (instance = new Grid(this, options)));
                init.call(instance);
            }
            if (typeof option === &quot;string&quot;)
            {
                if (option.indexOf(&quot;get&quot;) === 0 &amp;&amp; index === 0)
                {
                    returnValue = instance[option].apply(instance, args);
                }
                else if (option.indexOf(&quot;get&quot;) !== 0)
                {
                    return instance[option].apply(instance, args);
                }
            }
        });
    return (typeof option === &quot;string&quot; &amp;&amp; option.indexOf(&quot;get&quot;) === 0) ? returnValue : elements;
};

$.fn.bootgrid.Constructor = Grid;

// GRID NO CONFLICT
// ===============

$.fn.bootgrid.noConflict = function ()
{
    $.fn.bootgrid = old;
    return this;
};

// GRID DATA-API
// ============

$(&quot;[data-toggle=\&quot;bootgrid\&quot;]&quot;).bootgrid();
})(jQuery, window);
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
